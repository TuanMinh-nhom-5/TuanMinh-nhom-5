let mat_hangCNTT=[
    {
        id: 1,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/altas.jpg',
        tenGiaoTrinh :'Giáo trình atlag đồ giá',
        gia : 33000
    },
    {
        id: 2,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/bttkm.jpg',
        tenGiaoTrinh :'Bài tập thiết kế máy,chi tiết máy',
        gia : 66000
    },
    {
        id: 3,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/ckdc.jpg',
        tenGiaoTrinh :'Giáo trình cơ khí đại cương',
        gia : 35000
    },
    {
        id: 4,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/cnnoml.jpg',
        tenGiaoTrinh :'Công nghệ mẫu ống mẫu luồn',
        gia : 47000
    },
    {
        id: 5,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/cnxlvl.jpg',
        tenGiaoTrinh :'Công nghệ xử lí vật liệu',
        gia : 48000
    },
    {
        id: 6,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/cppgctt.jpg',
        tenGiaoTrinh :'Các phương pháp gia công tiên tiến',
        gia : 78000
    },
    {
        id: 7,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/cscnc.jpg',
        tenGiaoTrinh :'Cơ sở máy CNC',
        gia : 80000
    },
    {
        id: 8,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/ctcl.jpg',
        tenGiaoTrinh :'Giáo tiền cải tiến chất lượng',
        gia : 31000
    },
    {
        id: 9,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/dkmm.jpg',
        tenGiaoTrinh :'Điều khiển các máy cnc',
        gia : 65000
    },
    {
        id: 10,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/gbtnlm.jpg',
        tenGiaoTrinh :'Giả bài tập nguyên lý máy',
        gia : 43000
    },
    {
        id: 11,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/hdthktt.jpg',
        tenGiaoTrinh :'Hướng dẫn thực hành kỹ thuật tiện',
        gia : 42000
    },
    {
        id: 12,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/hdtkcv.jpg',
        tenGiaoTrinh :'Hướng dẫn thiết kế công việc',
        gia : 43000
    },
    {
        id: 13,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/hhhh.jpg',
        tenGiaoTrinh :'Giáo trình hình học họa hình',
        gia : 56000
    },
    {
        id: 14,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/htdoan.jpg',
        tenGiaoTrinh :'Hướng dẫn đồ án chi tiết máy',
        gia : 29000
    },
    {
        id: 15,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/htsanxuat.jpg',
        tenGiaoTrinh :'Hệ thống sản xuất',
        gia : 48000
    },
    {
        id: 16,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/ktkt.jpg',
        tenGiaoTrinh :'Kinh tế kỹ thuật',
        gia : 54000
    },
    {
        id: 17,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/ktkt.jpg',
        tenGiaoTrinh :'Kinh tế kỹ thuật',
        gia : 62000
    },
    {
        id: 18,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/meck.jpg',
        tenGiaoTrinh :'Máy ép cơ khí',
        gia : 60000
    },
    {
        id: 19,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/nlcatkl.jpg',
        tenGiaoTrinh :'Nguyên lý cắt kim loại',
        gia : 26000
    },
    {
        id: 20,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/nlgcvl.jpg',
        tenGiaoTrinh :'Nguyên lý gia công vật liệu',
        gia : 61000
    },
    {
        id: 21,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/qlduan.jpg',
        tenGiaoTrinh :'Quản lý dự án',
        gia : 98000
    },
    {
        id: 22,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/tdh.jpg',
        tenGiaoTrinh :'Tự động hóa',
        gia : 39000
    },
    {
        id: 23,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/tlvsmtl.jpg',
        tenGiaoTrinh :'Thủy lực và máy thủy lực',
        gia : 40000
    },
    {
        id: 24,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/vekithuat.jpg',
        tenGiaoTrinh :'Giáo trình vẽ kỹ thuật',
        gia : 50000
    },
    {
        id: 25,
        anh : './Anh/CÔNG NGHỆ KỸ THUẬT CƠ KHÍ/vktck.jpg',
        tenGiaoTrinh :'Vẽ kỹ thuật cơ khí',
        gia : 60000
    }
]
let mathangCNTT=document.querySelector('#mat_hang');
let cuaSo_muahang=document.querySelector('#cuaSo_muahang');
function renderSp(matHang,sanpham,fn){
    let html=matHang.map(function(matHang){
    return `
    <div class="matHang">
        <img src="${matHang.anh}" alt="">
        <p id="tenSanPham">${matHang.tenGiaoTrinh}</p>
        <h4 id="giaTien">${matHang.gia}đ</h4>
        <div id="themVaoGioHang" onclick="xuLiMuaHang(${fn},${matHang.id})">THÊM VÀO GIỎ HÀNG</div>
    </div>
    `
})
    sanpham.innerHTML=html.join('');
}
function Close(){
    let cuaSo_muahang=document.querySelector('#cuaSo_muahang')
    let close=cuaSo_muahang.querySelector('i')
    cuaSo_muahang.classList.remove('active')
}
function xuLiGioHang(matHang){
    let api='http://localhost:3000/gioHang'
    let options = {
        method: 'POST',
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(matHang)
      }
      fetch(api,options)
        .then(function(res){
          return res.json()
        })
        .then(function(a){
            console.log(a)
        })
}
function xuLiMuaHang(matHang,id){
    let myPromise = new Promise(function(myResolve, myReject) {
        let x = 0;
      
      // The producing code (this may take some time)
      
        if (x == 0) {
          myResolve("OK");
        } else {
          myReject("Error");
        }
      });
      myPromise.then(
        function(){
            let thongTinSP= cuaSo_muahang.querySelector('#hienThi')
            cuaSo_muahang.classList.add('active')
            let temp={};
            matHang.forEach(function(matHang,index){
            if(matHang.id===id){
            temp={
                tenGiaoTrinh : matHang.tenGiaoTrinh,
                gia : matHang.gia,
                anh : matHang.anh
            };
            thongTinSP.innerHTML=`
            <img src="${matHang.anh}" alt="">
            <div id="thongTin_SP">
                <h3 id="tenSP">${matHang.tenGiaoTrinh}</h3>
                <h2 id="gia">Giá : ${matHang.gia} Đ</h2>
                <div>Số lượng : <input type="number" id="soLuongSP" min="1" value="1")"></div>
                <button type="button" id="click_mua">Cho vào giỏ hàng</button>
            </div>
            <i class="fa-solid fa-circle-xmark dongCuaSo" onclick="Close()"></i>
            `
        }
    })
        return temp;
        }
      )
    .then(function(temp){
        let muaHang = document.querySelector('#click_mua')
        if(muaHang) muaHang.onclick=function(){
            cuaSo_muahang.classList.remove('active')
            temp.soLuong=document.querySelector('#soLuongSP').value
            xuLiGioHang(temp)
        }
    })
}
renderSp(mat_hangCNTT,mathangCNTT,'mat_hangCNTT');